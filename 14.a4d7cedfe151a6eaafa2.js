(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{Z0QX:function(t,e,c){"use strict";c.r(e),c.d(e,"CalendarSchedulerDayModule",(function(){return A}));var a=c("ofXK"),r=c("lJxs"),s=c("Brg/");class i{constructor(t){this.date=t.getTime()}}var n=c("fXoL"),o=c("S6We"),d=c("qmzK"),h=c("tyNb"),l=c("FHRb"),g=c("T1xj"),u=c("jVk7"),m=c("SV+Y"),p=c("XiUz"),f=c("Wp6s"),k=c("znSr"),b=c("NFeN");const v=function(t){return{"mat-card-day-selected":t}};function y(t,e){if(1&t){const t=n.ic();n.hc(0,"mat-card",10),n.pc("click",(function(){n.Hc(t);const c=e.$implicit;return n.tc(2).selectDate(c)})),n.hc(1,"div"),n.hc(2,"a"),n.Qc(3),n.uc(4,"date"),n.gc(),n.gc(),n.gc()}if(2&t){const t=e.$implicit,c=n.tc(2);n.zc("ngClass",n.Bc(5,v,c.isDaySelected(t))),n.Ob(3),n.Rc(n.wc(4,2,t,"E, d"))}}function O(t,e){if(1&t&&(n.hc(0,"mat-card",11),n.hc(1,"div"),n.Qc(2),n.uc(3,"date"),n.gc(),n.gc()),2&t){const t=e.$implicit;n.Ob(2),n.Rc(n.wc(3,1,t.date,"H"))}}const w=function(t){return{"":t}};function D(t,e){if(1&t&&n.cc(0,"div",15,16),2&t){const t=e.$implicit,c=n.Fc(1),a=n.tc().$implicit,r=n.tc(2);n.Qb(1===t.priority?"div-task-high-p":t-r.priority==2?"div-task-medium-p":"div-task-low-p"),n.zc("ngClass",n.Bc(3,w,r.taskRender(c,t,a,"regular")))}}function S(t,e){if(1&t&&(n.hc(0,"mat-card",11,12),n.hc(2,"div",13),n.Oc(3,D,2,5,"div",14),n.gc(),n.gc()),2&t){const t=n.tc(2);n.Nc("height","66vh"),n.Ob(3),n.zc("ngForOf",t.tasks)}}function x(t,e){if(1&t){const t=n.ic();n.hc(0,"div"),n.hc(1,"mat-icon",17),n.pc("click",(function(){n.Hc(t);const c=e.$implicit;return n.tc(2).checkTask.emit(c._id)})),n.Qc(2,"assignment"),n.gc(),n.gc()}2&t&&(n.Nc("height","30px"),n.Ob(1),n.Nc("margin-left","15px"))}function F(t,e){if(1&t&&(n.hc(0,"div",2),n.hc(1,"div",3),n.Oc(2,y,5,7,"mat-card",4),n.gc(),n.hc(3,"div",5),n.hc(4,"div",2),n.Oc(5,O,4,4,"mat-card",6),n.cc(6,"div",7),n.gc(),n.hc(7,"div",2),n.Oc(8,S,4,3,"mat-card",8),n.hc(9,"div",7),n.Oc(10,x,3,4,"div",9),n.gc(),n.gc(),n.gc(),n.gc()),2&t){const t=n.tc();n.Ob(2),n.zc("ngForOf",t.week),n.Ob(1),n.Nc("margin","10px"),n.Ob(1),n.Nc("width","95vw"),n.Ob(1),n.zc("ngForOf",t.hours),n.Ob(2),n.Nc("width","95vw"),n.Ob(1),n.zc("ngForOf",t.hours),n.Ob(1),n.Nc("background-color","#ffffff"),n.Ob(1),n.zc("ngForOf",t.tasks)}}const M=function(){return["mat-card-week-day","selected"]};function N(t,e){if(1&t){const t=n.ic();n.hc(0,"mat-card",13),n.hc(1,"div"),n.hc(2,"a",26),n.pc("click",(function(){n.Hc(t);const c=e.$implicit;return n.tc(2).selectDate(c)})),n.Qc(3),n.uc(4,"date"),n.gc(),n.gc(),n.gc()}if(2&t){const t=e.$implicit,c=n.tc(2);n.Qb(c.isDaySelected(t)?n.Ac(6,M):"mat-card-week-day"),n.Ob(3),n.Rc(n.wc(4,3,t,"d"))}}function T(t,e){if(1&t){const t=n.ic();n.hc(0,"div",27),n.hc(1,"mat-icon",26),n.pc("click",(function(){n.Hc(t);const c=e.$implicit;return n.tc(2).checkTask.emit(c._id)})),n.Qc(2,"remove_red_eye"),n.gc(),n.gc()}2&t&&n.Nc("margin-left","2vw")("width","15px")}function C(t,e){if(1&t&&(n.hc(0,"div",28),n.Qc(1),n.uc(2,"date"),n.gc()),2&t){const t=e.$implicit,c=n.tc(2);n.Nc("height",100/c.hours.length,"%"),n.Ob(1),n.Sc(" ",n.wc(2,3,t.date,"H")," ")}}function z(t,e){if(1&t&&n.cc(0,"div",15,16),2&t){const t=e.$implicit,c=n.Fc(1),a=n.tc().$implicit,r=n.tc(2);n.Nc("margin-left","2vw")("width","15px"),n.zc("ngClass",n.Bc(5,w,r.taskRender(c,t,a,"small")))}}function R(t,e){if(1&t&&(n.hc(0,"div",2),n.Oc(1,z,2,7,"div",29),n.gc()),2&t){const t=n.tc(2);n.Nc("height",100/t.hours.length,"%"),n.Ob(1),n.zc("ngForOf",t.tasks)}}function P(t,e){if(1&t&&(n.hc(0,"div",13),n.hc(1,"div",18),n.Oc(2,N,5,7,"mat-card",19),n.gc(),n.hc(3,"div",20),n.hc(4,"div",2),n.Oc(5,T,3,4,"div",21),n.gc(),n.hc(6,"div",22),n.hc(7,"div",13),n.Oc(8,C,3,6,"div",23),n.gc(),n.hc(9,"mat-card",24),n.Oc(10,R,2,3,"div",25),n.gc(),n.gc(),n.gc(),n.gc()),2&t){const t=n.tc();n.Ob(2),n.zc("ngForOf",t.week),n.Ob(1),n.Nc("margin-top","10px"),n.Ob(1),n.Nc("width","92vw")("margin-left","22px"),n.Ob(1),n.zc("ngForOf",t.tasks),n.Ob(2),n.Nc("height","52vh"),n.Ob(1),n.zc("ngForOf",t.hours),n.Ob(2),n.zc("ngForOf",t.hours)}}let j=(()=>{class t{constructor(t,e,c){this.renderer=t,this.tasksService=e,this.mdService=c,this.tasks=[],this.tasksRenderized=0,this.checkTask=new n.r,this.putTask=new n.r,this.dateSelection=new n.r}ngOnChanges(t){t.tasks&&this.tasks&&(this.tasksRenderized=0),t.selectedDate&&this.selectedDate&&(this.week=this.getWeek(this.selectedDate))}taskRender(t,e,c,a){if(this.hasTask(e,c)&&this.tasksRenderized<=this.tasks.length*this.hours.length*2){let r=0;c.date+36e5-e.startDate>36e5&&e.endDate-c.date>36e5?(r=100,this.renderTask(t,a,r,e)):c.date-e.startDate<36e5?(r=Math.floor(100*(c.date+36e5-e.startDate)/36e5),"regular"===a?this.renderer.setStyle(t,"margin-left",100-r+"%"):this.renderer.setStyle(t,"margin-top",r*(52/this.hours.length)/100+"vh"),r-=Math.round(e.endDate<c.date+36e5?100*(c.date+36e5-e.endDate)/36e5:0),this.renderTask(t,a,r,e)):(r=Math.ceil(100*(e.endDate-c.date)/36e5),"regular"===a?this.renderer.setStyle(t,"margin-right",100-r+"%"):this.renderer.setStyle(t,"margin-bottom",r*(52/this.hours.length)/100+"vh}%"),r-=Math.round(e.endDate<c.date+36e5?100*(c.date+36e5-e.endDate)/36e5:0),this.renderTask(t,a,r,e))}}hasTask(t,e){return e.date+36e5>t.startDate&&e.date<t.endDate}renderTask(t,e,c,a){"regular"===e?(this.renderer.setStyle(t,"background-color",this.taskColor(a)),this.renderer.setStyle(t,"width",c+"%")):(this.renderer.setStyle(t,"background-color",this.taskColor(a)),this.renderer.setStyle(t,"height",c+"%")),this.tasksRenderized++}taskColor(t){let e=new Date,c=u.a;return t.endDate>e.getTime()?t.endDate>e.getTime()+c?"#5464bd":"#d1870c":"#ff0000"}getWeek(t){let e=[];for(let c=-t.getDay();c<7-t.getDay();c++)e.push(new Date(t.getFullYear(),t.getMonth(),t.getDate()+c));return e}isDaySelected(t){return class{static dateComparison(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}static isRangeInRange(t,e){return t.start<=e.start&&t.end>=e.end}static createMonthlyRange(t){let e=new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),c=new Date(t.getFullYear(),t.getMonth(),e,0,0,0,0),a=new Date(t.getFullYear(),t.getMonth(),1,0,0,0,0),r={start:null,end:null},s=new Date(t.getFullYear(),t.getMonth(),1-a.getDay()),i=new Date(t.getFullYear(),t.getMonth(),e+(6-c.getDay()),23,59,59,0);return r.start=s,r.end=i,r}static milisecondsToPeriod(t,e){let c=[],a=(e-t)/1e3;if(Number(String(a).split(".")[0])>0){a=Number(String(a).split(".")[0]);let t=a/60;if(Math.round(60*Number("0."+String(t).split(".")[1]))>=1&&c.push(Math.round(60*Number("0."+String(t).split(".")[1]))+(Math.round(60*Number("0."+String(t).split(".")[1]))>1?" seconds":"seconds")),Number(String(t).split(".")[0])>0){t=Number(String(t).split(".")[0]);let e=t/60;if(Math.round(60*Number("0."+String(e).split(".")[1]))>=1&&c.push(Math.round(60*Number("0."+String(e).split(".")[1]))+(Math.round(60*Number("0."+String(e).split(".")[1]))>1?" minutes":" minute")),Number(String(e).split(".")[0])>0){e=Number(String(e).split(".")[0]);let t=e/24;Math.round(24*Number("0."+String(t).split(".")[1]))>=1&&c.push(Math.round(24*Number("0."+String(t).split(".")[1]))+(Math.round(24*Number("0."+String(t).split(".")[1]))>1?" hours":" hour")),Number(String(t).split(".")[0])>0&&(t=Number(String(t).split(".")[0]),c.push(t+" days"))}}}return c.reverse()}static milisecsToString(t){return this.milisecondsToPeriod(0,t)}static monthValue(t){let e;if("string"==typeof t)switch(t){case"january":e=0;break;case"february":e=1;break;case"march":e=2;break;case"april":e=3;break;case"may":e=4;break;case"june":e=5;break;case"july":e=6;break;case"august":e=7;break;case"september":e=8;break;case"october":e=9;break;case"november":e=10;break;case"december":e=11}else switch(t){case 0:e="january";break;case 1:e="february";break;case 2:e="march";break;case 3:e="april";break;case 4:e="may";break;case 5:e="june";break;case 6:e="july";break;case 7:e="august";break;case 8:e="september";break;case 9:case 10:e="october";break;case 11:e="december"}return e.toString()}}.dateComparison(t,this.selectedDate)}selectDate(t){this.selectedDate=t,s.c.set("state-data",this.selectedDate,"date-selected"),this.dateSelection.next(this.selectedDate)}}return t.\u0275fac=function(e){return new(e||t)(n.bc(n.Q),n.bc(o.a),n.bc(m.a))},t.\u0275cmp=n.Vb({type:t,selectors:[["app-calendar-scheduler-day"]],inputs:{hours:"hours",tasks:"tasks",selectedDate:"selectedDate"},outputs:{checkTask:"checkTask",putTask:"putTask",dateSelection:"dateSelection"},features:[n.Mb],decls:2,vars:2,consts:[["fxLayout","row",4,"ngIf"],["fxLayout","column",4,"ngIf"],["fxLayout","row"],["fxFlex","5","fxLayout","column"],["class","mat-card-day","fxLayout","column",3,"ngClass","click",4,"ngFor","ngForOf"],["fxFlex","95","fxLayout","column"],["fxFlex","90","class","mat-card-hour",4,"ngFor","ngForOf"],["fxFlex","10"],["fxFlex","90","class","mat-card-hour",3,"height",4,"ngFor","ngForOf"],[3,"height",4,"ngFor","ngForOf"],["fxLayout","column",1,"mat-card-day",3,"ngClass","click"],["fxFlex","90",1,"mat-card-hour"],["cardHour",""],["fxLayout","column"],[3,"class","ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["taskDiv",""],["color","primary",3,"click"],["fxFlex","10","fxLayout","row"],["fxLayout","column",3,"class",4,"ngFor","ngForOf"],["fxLayout","column","fxFlex","90"],["fxLayoutAlign","center",3,"margin-left","width",4,"ngFor","ngForOf"],["fxFlex","100","fxHide.gt-sm","","fxShow.lt-md","","fxLayout","row"],["class","div-date",3,"height",4,"ngFor","ngForOf"],["fxLayout","column",1,"div-scrollable-tasks"],["fxLayout","row",3,"height",4,"ngFor","ngForOf"],[3,"click"],["fxLayoutAlign","center"],[1,"div-date"],[3,"margin-left","width","ngClass",4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(n.Oc(0,F,11,12,"div",0),n.Oc(1,P,11,12,"div",1)),2&t&&(n.zc("ngIf",e.mdService.desktop),n.Ob(1),n.zc("ngIf",!e.mdService.desktop))},directives:[a.t,p.f,p.b,a.s,f.a,a.q,k.a,b.a,k.c,p.e],pipes:[a.f],styles:[".mat-card-day[_ngcontent-%COMP%]{cursor:pointer;height:9.5vh;padding:5px!important}.mat-card-day-selected[_ngcontent-%COMP%]{background-color:#d1870c!important}.mat-card-hour[_ngcontent-%COMP%]{padding:0!important;margin:0!important;width:5.5vw;height:3.3vh}.div-task-low-p[_ngcontent-%COMP%]{height:10px;margin-top:10px;margin-bottom:10px}.div-task-medium-p[_ngcontent-%COMP%]{height:15px;margin-bottom:7.5px;margin-top:7.5px}.div-task-high-p[_ngcontent-%COMP%]{height:20px;margin-bottom:5px;margin-top:5px}.a-task-toggle[_ngcontent-%COMP%]{margin:5px;color:#5464bd;word-break:break-all;max-width:100%}.div-scrollable-tasks[_ngcontent-%COMP%]{overflow-x:scroll;width:92vw;overflow-y:hidden;margin:0;padding:0;height:52vh}.mat-card-week-day[_ngcontent-%COMP%]{width:15%;padding:0;height:25px!important}.mat-card-week-day.selected[_ngcontent-%COMP%]{background-color:#d1870c!important}.div-date[_ngcontent-%COMP%]{background-color:#5464bd;color:#fff;width:22px;text-align:center}"],changeDetection:0}),t})(),L=(()=>{class t{constructor(t,e,c,a,r,s){this.taskService=t,this.dialogService=e,this.cdr=c,this.ar=a,this.calendarSchedulerComponent=r,this.projectService=s,this.hoursRange={start:7,end:24},this.hours=[],this.tasks=[]}ngOnInit(){this.ar.queryParamMap.subscribe(t=>{this.selectedDate=new Date(t.get("date")),this.selectedProject=this.projectService.selectedProject._id,this.init()}),this.taskSubscription=this.taskService.task$.subscribe(()=>{this.init()})}init(){this.hours=[];for(let t=this.hoursRange.start;t<this.hoursRange.end;t++)this.hours.push(new i(new Date(this.selectedDate.getFullYear(),this.selectedDate.getMonth(),this.selectedDate.getDate(),t,0,0,0)));this.timeRange=[this.selectedDate.getTime(),this.selectedDate.getTime()+864e5],this.taskService.getTasks("day",s.d.toQueryString({project:this.selectedProject,from:this.timeRange[0],to:this.timeRange[1]})).pipe(Object(r.a)(t=>t.tasks)).subscribe(t=>{this.tasks=[...t],this.cdr.detectChanges()})}dateSelection(t){this.calendarSchedulerComponent.searchByDate(t)}checkTask(t){this.dialogService.openTaskInfoDialog(t)}putTask(t){this.dialogService.openEditCreateTaskDialog(t)}ngOnDestroy(){this.taskSubscription&&this.taskSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(n.bc(o.a),n.bc(d.a),n.bc(n.i),n.bc(h.a),n.bc(l.a),n.bc(g.a))},t.\u0275cmp=n.Vb({type:t,selectors:[["app-calendar-scheduler-day-smart"]],decls:1,vars:3,consts:[[3,"hours","tasks","selectedDate","checkTask","putTask","dateSelection"]],template:function(t,e){1&t&&(n.hc(0,"app-calendar-scheduler-day",0),n.pc("checkTask",(function(t){return e.checkTask(t)}))("putTask",(function(t){return e.putTask(t)}))("dateSelection",(function(t){return e.dateSelection(t)})),n.gc()),2&t&&n.zc("hours",e.hours)("tasks",e.tasks)("selectedDate",e.selectedDate)},directives:[j],encapsulation:2,changeDetection:0}),t})();var _=c("YUcS"),$=c("jAig"),Y=c("+Mmm"),Q=c("zAIM"),H=c("tb/P");let I=[{path:"",component:L}],A=(()=>{class t{}return t.\u0275mod=n.Zb({type:t}),t.\u0275inj=n.Yb({factory:function(e){return new(e||t)},imports:[[a.c,h.g.forChild(I),$.a,_.a,Q.a,Y.a,H.a]]}),t})()}}]);