(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"5q21":function(t,e,a){"use strict";a.r(e),a.d(e,"TaskManagerModule",(function(){return tt}));var c=a("ofXK"),s=a("YUcS"),i=a("PyEr"),n=a("tyNb"),r=a("vkgz"),o=a("Brg/"),l=a("fXoL"),g=a("T1xj"),h=a("S6We"),d=a("SV+Y"),p=a("3TL5"),m=a("XiUz"),u=a("znSr"),f=a("bTqV"),k=a("STbY"),b=a("NFeN"),S=a("kmnG"),v=a("qFsG"),x=a("3Pt+"),O=a("d3UM"),y=a("e/WU"),M=a("FKr1");function T(t,e){if(1&t&&(l.hc(0,"mat-option",19),l.Qc(1),l.gc()),2&t){const t=e.$implicit;l.zc("value",t),l.Ob(1),l.Rc(t)}}function w(t,e){if(1&t&&(l.hc(0,"mat-option",19),l.Qc(1),l.gc()),2&t){const t=e.$implicit;l.zc("value",t.value),l.Ob(1),l.Rc(t.label)}}function C(t,e){if(1&t&&(l.hc(0,"mat-option",19),l.Qc(1),l.gc()),2&t){const t=e.$implicit;l.zc("value",t._id),l.Ob(1),l.Rc(t.name)}}function L(t,e){if(1&t&&(l.hc(0,"mat-option",19),l.Qc(1),l.gc()),2&t){const t=e.$implicit;l.zc("value",t._id),l.Ob(1),l.Rc(t.name)}}let I=(()=>{class t{constructor(){this.getItems=new l.r,this.filters={_id:"",name:"",createdBy:"",participants:[],status:"",from:null,to:null,priority:"",project:""},this.options={status:["done","pending","overdue"],createdBy:[],participants:[],priority:[{label:"low",value:3},{label:"medium",value:2},{label:"high",value:1}]}}ngOnInit(){this.filters.project=this.projectId}ngOnChanges(t){t.participants&&this.participants&&(this.options.participants=o.d.copyObject(this.participants),this.options.createdBy=this.participants.filter(t=>"ADMIN_ROLE"===t.role))}setDate(t,e){this.filters[e]=t.getTime()}searchItems(){let t=o.d.toQueryString(this.filters);this.getItems.next(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Vb({type:t,selectors:[["app-task-manager-filter"]],inputs:{projectId:"projectId",participants:"participants"},outputs:{getItems:"getItems"},features:[l.Mb],decls:49,vars:19,consts:[["fxLayoutAlign","center"],["mat-button","","mat-mini-fab","","color","accent","ngClass.gt-xs","btn-search-desktop","ngClass.xs","btn-search-mobile",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],["filtersMenu","matMenu"],["fxLayout","column",3,"click"],["fxLayout","row","fxLayoutAlign","space-around","fxLayoutGap","15px"],["fxFlex","40",1,"example-full-width"],["matInput","","placeholder","Task ID","autocomplete","off",3,"ngModel","ngModelChange"],["matInput","","placeholder","Task name","autocomplete","off",3,"ngModel","ngModelChange"],["fxLayout","row","fxLayoutGap","15px","fxLayoutAlign","space-around"],["fxFlex","40","appearance","fill"],["matNativeControl","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["multiple","","matNativeControl","",3,"ngModel","ngModelChange"],["fxLayout","column","fxLayoutAlign","center","fxFlex","40",1,"dates-container"],["dateFormat","time","placeholder","Start date",3,"ngModel","ngModelChange"],["dateFormat","time","placeholder","End date",3,"ngModel","ngModelChange"],["fxFlex","40","fxLayoutAlign","space-around"],["mat-mini-fab","","color","accent",1,"btn-search-dialog",3,"click"],[3,"value"]],template:function(t,e){if(1&t){const t=l.ic();l.hc(0,"div",0),l.hc(1,"button",1,2),l.hc(3,"mat-icon"),l.Qc(4,"search"),l.gc(),l.gc(),l.gc(),l.hc(5,"mat-menu",null,3),l.hc(7,"div",4),l.pc("click",(function(t){return t.stopPropagation()})),l.hc(8,"div",5),l.hc(9,"mat-form-field",6),l.hc(10,"mat-label"),l.Qc(11,"ID"),l.gc(),l.hc(12,"input",7),l.pc("ngModelChange",(function(t){return e.filters._id=t})),l.gc(),l.gc(),l.hc(13,"mat-form-field",6),l.hc(14,"mat-label"),l.Qc(15,"Name"),l.gc(),l.hc(16,"input",8),l.pc("ngModelChange",(function(t){return e.filters.name=t})),l.gc(),l.gc(),l.gc(),l.hc(17,"div",9),l.hc(18,"mat-form-field",10),l.hc(19,"mat-label"),l.Qc(20,"Status"),l.gc(),l.hc(21,"mat-select",11),l.pc("ngModelChange",(function(t){return e.filters.status=t})),l.Oc(22,T,2,2,"mat-option",12),l.gc(),l.gc(),l.hc(23,"mat-form-field",10),l.hc(24,"mat-label"),l.Qc(25,"Priority"),l.gc(),l.hc(26,"mat-select",11),l.pc("ngModelChange",(function(t){return e.filters.priority=t})),l.Oc(27,w,2,2,"mat-option",12),l.gc(),l.gc(),l.gc(),l.hc(28,"div",9),l.hc(29,"mat-form-field",10),l.hc(30,"mat-label"),l.Qc(31,"Creator/editor"),l.gc(),l.hc(32,"mat-select",11),l.pc("ngModelChange",(function(t){return e.filters.createdBy=t})),l.Oc(33,C,2,2,"mat-option",12),l.gc(),l.gc(),l.hc(34,"mat-form-field",10),l.hc(35,"mat-label"),l.Qc(36,"Participants"),l.gc(),l.hc(37,"mat-select",13),l.pc("ngModelChange",(function(t){return e.filters.participants=t})),l.Oc(38,L,2,2,"mat-option",12),l.gc(),l.gc(),l.gc(),l.hc(39,"div",5),l.hc(40,"div",14),l.hc(41,"lp-date-selector",15),l.pc("ngModelChange",(function(t){return e.setDate(t,"from")})),l.uc(42,"lpParseDate"),l.gc(),l.hc(43,"lp-date-selector",16),l.pc("ngModelChange",(function(t){return e.setDate(t,"to")})),l.uc(44,"lpParseDate"),l.gc(),l.gc(),l.hc(45,"div",17),l.hc(46,"button",18),l.pc("click",(function(){l.Hc(t);const a=l.Fc(2);return e.searchItems(),a.closeMenu()})),l.hc(47,"mat-icon"),l.Qc(48,"search"),l.gc(),l.gc(),l.gc(),l.gc(),l.gc(),l.gc()}if(2&t){const t=l.Fc(6);l.Ob(1),l.zc("matMenuTriggerFor",t),l.Ob(11),l.zc("ngModel",e.filters._id),l.Ob(4),l.zc("ngModel",e.filters.name),l.Ob(5),l.zc("ngModel",e.filters.status),l.Ob(1),l.zc("ngForOf",e.options.status),l.Ob(4),l.zc("ngModel",e.filters.priority),l.Ob(1),l.zc("ngForOf",e.options.priority),l.Ob(5),l.zc("ngModel",e.filters.createdBy),l.Ob(1),l.zc("ngForOf",e.options.createdBy),l.Ob(4),l.zc("ngModel",e.filters.participants),l.Ob(1),l.zc("ngForOf",e.options.participants),l.Ob(3),l.zc("ngModel",l.wc(42,13,e.filters.from,"date")),l.Ob(2),l.zc("ngModel",l.wc(44,16,e.filters.to,"date"))}},directives:[m.e,f.b,u.a,k.d,b.a,k.e,m.f,m.g,S.c,m.b,S.g,v.b,x.d,x.o,x.r,O.a,c.s,y.a,M.n],pipes:[i.b],styles:[".dates-container[_ngcontent-%COMP%]{margin:20px}.btn-search-desktop[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:10px}.btn-search-mobile[_ngcontent-%COMP%]{margin:15px}.btn-search-dialog[_ngcontent-%COMP%]{margin-top:25px}  .mat-menu-panel{top:0;max-width:none!important}"],changeDetection:0}),t})();var z=a("+0xr"),F=a("M9IT");const P=["paginator"];function _(t,e){1&t&&(l.hc(0,"th",12),l.Qc(1," Name "),l.gc())}function Q(t,e){if(1&t&&(l.hc(0,"td",13),l.hc(1,"p",14),l.Qc(2),l.gc(),l.gc()),2&t){const t=e.$implicit;l.Ob(2),l.Rc(t.name)}}function D(t,e){1&t&&(l.hc(0,"th",12),l.Qc(1," Status "),l.gc())}const j=function(t){return{color:t}};function A(t,e){if(1&t&&(l.hc(0,"td",13),l.hc(1,"p",15),l.Qc(2),l.gc(),l.gc()),2&t){const t=e.$implicit;l.Ob(1),l.zc("ngStyle",l.Bc(2,j,!0===t.status?"#7b87cc":"#d1870c")),l.Ob(1),l.Sc(" ",t.status," ")}}function N(t,e){1&t&&(l.hc(0,"th",12),l.Qc(1," Priority "),l.gc())}function R(t,e){if(1&t&&(l.hc(0,"td",13),l.hc(1,"p",16),l.Qc(2),l.gc(),l.hc(3,"p",17),l.Qc(4),l.gc(),l.gc()),2&t){const t=e.$implicit;l.Ob(2),l.Sc(" ",1===t.priority?"LOW":2===t.priority?"MEDIUM":"HIGH"," "),l.Ob(2),l.Rc(t.priority)}}function E(t,e){1&t&&l.cc(0,"th",12)}function $(t,e){if(1&t){const t=l.ic();l.hc(0,"td",13),l.hc(1,"mat-icon",18),l.pc("click",(function(){l.Hc(t);const a=e.$implicit,c=l.tc();return c.taskSelected!=a._id?c.selectTask.next(a._id):null})),l.Qc(2,"launch"),l.gc(),l.gc()}if(2&t){const t=e.$implicit,a=l.tc();l.Ob(1),l.zc("color",a.taskSelected===t._id?"accent":"primary")}}function H(t,e){1&t&&l.cc(0,"tr",19)}function B(t,e){1&t&&l.cc(0,"tr",20)}let V=(()=>{class t{constructor(){this.pageSize=5,this.taskTotal=0,this.taskFrom=0,this.tasksList=[],this.selectTask=new l.r,this.getItems=new l.r,this.displayedColumns=["name","status","priority","options"]}ngOnInit(){}ngOnChanges(t){t.taskTotal&&null!=this.taskTotal&&this.paginator&&(this.paginator.pageIndex=0)}paginatorChange(t){this.getItems.emit(this.pageSize*t.pageIndex)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Vb({type:t,selectors:[["app-task-manager-list"]],viewQuery:function(t,e){var a;1&t&&l.Wc(P,!0),2&t&&l.Ec(a=l.qc())&&(e.paginator=a.first)},inputs:{taskTotal:"taskTotal",taskFrom:"taskFrom",taskSelected:"taskSelected",tasksList:"tasksList"},outputs:{selectTask:"selectTask",getItems:"getItems"},features:[l.Mb],decls:18,vars:5,consts:[["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","priority"],["matColumnDef","options","stickyEnd",""],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["fxLayoutAlign","center"],["fxFlex","100",3,"length","pageSize","page"],["paginator",""],["mat-header-cell",""],["mat-cell",""],[1,"p-name"],[3,"ngStyle"],["fxHide.xs","","fxShow.gt-xs",""],["fxHide.gt-xs","","fxShow.xs",""],[3,"color","click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(l.hc(0,"table",0),l.fc(1,1),l.Oc(2,_,2,0,"th",2),l.Oc(3,Q,3,1,"td",3),l.ec(),l.fc(4,4),l.Oc(5,D,2,0,"th",2),l.Oc(6,A,3,4,"td",3),l.ec(),l.fc(7,5),l.Oc(8,N,2,0,"th",2),l.Oc(9,R,5,2,"td",3),l.ec(),l.fc(10,6),l.Oc(11,E,1,0,"th",2),l.Oc(12,$,3,1,"td",3),l.ec(),l.Oc(13,H,1,0,"tr",7),l.Oc(14,B,1,0,"tr",8),l.gc(),l.hc(15,"div",9),l.hc(16,"mat-paginator",10,11),l.pc("page",(function(t){return e.paginatorChange(t)})),l.gc(),l.gc()),2&t&&(l.zc("dataSource",e.tasksList),l.Ob(13),l.zc("matHeaderRowDef",e.displayedColumns),l.Ob(1),l.zc("matRowDefColumns",e.displayedColumns),l.Ob(2),l.zc("length",e.taskTotal)("pageSize",e.pageSize))},directives:[z.o,z.c,z.i,z.b,z.k,z.n,m.e,F.a,m.b,z.h,z.a,c.w,u.d,u.c,b.a,z.j,z.m],styles:["table[_ngcontent-%COMP%]{width:100%!important}.p-name[_ngcontent-%COMP%]{word-break:break-all;margin-right:3px}"]}),t})();var q=a("wZkO");function U(t,e){if(1&t){const t=l.ic();l.hc(0,"nav",9),l.hc(1,"a",10),l.pc("click",(function(){return l.Hc(t),l.tc().setView(0)})),l.hc(2,"mat-icon"),l.Qc(3,"list"),l.gc(),l.gc(),l.hc(4,"a",10),l.pc("click",(function(){return l.Hc(t),l.tc().setView(1)})),l.hc(5,"span",11),l.Qc(6),l.gc(),l.gc(),l.gc()}if(2&t){const t=l.tc();l.Ob(2),l.Nc("color",0===t.indexSelected?"#5153a8":""),l.Ob(3),l.Nc("color",1===t.indexSelected?"#5153a8":""),l.Ob(1),l.Rc(t.taskSelected?t.taskSelectedName:"")}}function W(t,e){1&t&&(l.hc(0,"h4",12),l.Qc(1,"NO TASK SELECTED"),l.gc())}const X=function(t){return{display:t}};let Y=[{path:"",component:(()=>{class t{constructor(t,e,a,c,s,i,n){this.projectService=t,this.taskService=e,this.ar=a,this.router=c,this.mdService=s,this.routesService=i,this.cdr=n,this.tasksList=[],this.taskSkip=0,this.taskLimit=5,this.taskSubs=null,this.indexSelected=0}get taskSelectedName(){const t=this.tasksList.length>0?this.tasksList.find(t=>t._id===this.taskSelected):void 0;return t?t.name:""}ngOnInit(){this.routesService.setCurrentPage("task-manager"),this.arSubscription=this.ar.parent.parent.paramMap.subscribe(t=>{const e=t.get("id");this.init(e)}),this.ar.parent.paramMap.subscribe(()=>{})}init(t){this.getTasks("?project="+t,0).subscribe(t=>{if(this.tasksList=t.tasks,this.ar.firstChild)this.taskSelected=this.ar.firstChild.snapshot.paramMap.get("id");else{const t=o.c.get("state-data","task-selected");t&&this.tasksList.find(e=>e._id===t)?this.navigateToTask(t,o.c.get("state-data","task-manager-tab")||"info"):(this.removeTaskInStorage(),this.tasksList[this.tasksList.length-1]?this.navigateToTask(this.tasksList[this.tasksList.length-1]._id,o.c.get("state-data","task-manager-tab")||"info"):this.taskSelected="")}}),this.getParticipants(t),this.listenTaskChanges()}listenTaskChanges(){this.taskSubs=this.taskService.task$.subscribe(t=>{if(console.log({res:t}),t)switch(t.action){case"POST":this.taskTotal++,this.taskLimit>this.tasksList.length&&(this.tasksList=[...this.tasksList,t.task]),this.taskSelected||this.navigateToTask(t.task._id,o.c.get("state-data","task-manager-tab")||"info");break;case"PUT":this.tasksList=this.tasksList.map(e=>e._id===t.task._id?t.task:e);break;case"DELETE":this.tasksList=this.tasksList.filter(e=>e._id!=t.task._id),this.taskSelected=t.task._id===this.taskSelected?"":this.taskSelected}})}getParticipants(t){this.projectService.getParticipants(t).subscribe(t=>{this.participants=t})}getTasks(t,e){return this.taskQueryString=t,this.taskSkip=e,this.taskService.getTasks("month",this.taskQueryString,this.taskSkip,this.taskLimit).pipe(Object(r.a)(t=>{this.taskTotal=t.count,this.tasksList=t.tasks}))}selectTask(t){this.navigateToTask(t,o.c.get("state-data","task-manager-tab")||"info"),this.indexSelected=1}setTaskInStorage(){o.c.set("state-data",this.taskSelected,"task-selected")}removeTaskInStorage(){o.c.remove("state-data","task-selected")}navigateToTask(t,e){this.taskSelected=t,this.router.navigate(["task-manager",this.taskSelected,e],{relativeTo:this.ar.parent.parent}).then(()=>{this.setTaskInStorage()})}ngOnDestroy(){this.taskSubs&&null!=this.taskSubs&&this.taskSubs.unsubscribe(),this.arSubscription.unsubscribe()}setView(t){this.indexSelected=t,this.cdr.detectChanges()}}return t.\u0275fac=function(e){return new(e||t)(l.bc(g.a),l.bc(h.a),l.bc(n.a),l.bc(n.d),l.bc(d.a),l.bc(p.a),l.bc(l.i))},t.\u0275cmp=l.Vb({type:t,selectors:[["app-task-manager"]],decls:12,vars:13,consts:[["fxLayoutAlign.gt-sm","space-around","fxLayout.lt-md","column","fxLayout.gt-sm","row",1,"task-manager-container"],["mat-stretch-tabs","","mat-tab-nav-bar","",4,"ngIf"],["fxFlex","100","fxLayout.gt-sm","row","fxLayout.lt-md","column","fxLayoutAlign.gt-sm","space-around"],["fxFlex.gt-sm","22","fxFlex.md","35","fxFlex.lt-md","30","fxLayout","column",3,"ngStyle"],["fxLayoutAlign","center"],["fxFlex","100",3,"participants","projectId","getItems"],["fxFlex","100",3,"tasksList","taskSelected","taskTotal","selectTask","getItems"],["fxFlex.gt-sm","75","fxFlex.lt-md","70",3,"ngStyle"],["class","div-no-tasks",4,"ngIf"],["mat-stretch-tabs","","mat-tab-nav-bar",""],["mat-tab-link","",3,"click"],[1,"span-task-name"],[1,"div-no-tasks"]],template:function(t,e){1&t&&(l.hc(0,"div",0),l.Oc(1,U,7,5,"nav",1),l.hc(2,"div",2),l.hc(3,"div",3),l.hc(4,"div",4),l.hc(5,"app-task-manager-filter",5),l.pc("getItems",(function(t){return e.getTasks(t,0).subscribe()})),l.gc(),l.gc(),l.hc(6,"div",4),l.hc(7,"app-task-manager-list",6),l.pc("selectTask",(function(t){return e.selectTask(t)}))("getItems",(function(t){return e.getTasks(e.taskQueryString,t).subscribe()})),l.gc(),l.gc(),l.gc(),l.hc(8,"div",7),l.cc(9,"router-outlet"),l.hc(10,"div",4),l.Oc(11,W,2,0,"h4",8),l.gc(),l.gc(),l.gc(),l.gc()),2&t&&(l.Ob(1),l.zc("ngIf",!e.mdService.desktop),l.Ob(2),l.zc("ngStyle",l.Bc(9,X,e.mdService.desktop||!e.mdService.desktop&&0===e.indexSelected?"":"none")),l.Ob(2),l.zc("participants",e.participants)("projectId",e.selectedProject),l.Ob(2),l.zc("tasksList",e.tasksList)("taskSelected",e.taskSelected?e.taskSelected:null)("taskTotal",e.taskTotal),l.Ob(1),l.zc("ngStyle",l.Bc(11,X,e.mdService.desktop||!e.mdService.desktop&&1===e.indexSelected?"":"none")),l.Ob(3),l.zc("ngIf",!e.taskSelected))},directives:[m.e,m.f,c.t,m.b,c.w,u.d,I,V,n.h,q.f,q.e,b.a],styles:[".task-manager-container[_ngcontent-%COMP%]{height:88vh}@media (max-width:1279px){.task-manager-container[_ngcontent-%COMP%]{height:75vh!important}}  .mat-tab-body-wrapper{height:100%!important;margin:0!important}.div-no-tasks[_ngcontent-%COMP%]{margin:50px}.span-task-name[_ngcontent-%COMP%]{width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}"]}),t})(),children:[{path:":id",loadChildren:()=>Promise.all([a.e(0),a.e(16)]).then(a.bind(null,"UjWm")).then(t=>t.TaskManagerPanelModule),canActivate:[(()=>{class t{constructor(t,e,a){this.taskService=t,this.router=e,this.projectService=a}canActivate(t,e){const a=this.projectService.selectedProject._id,c=t.paramMap.get("id");return c?this.taskService.userIsPartOfTask(c,a):(this.router.navigate(["/"]),!1)}}return t.\u0275fac=function(e){return new(e||t)(l.lc(h.a),l.lc(n.d),l.lc(g.a))},t.\u0275prov=l.Xb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()]}]}],G=(()=>{class t{}return t.\u0275mod=l.Zb({type:t}),t.\u0275inj=l.Yb({factory:function(e){return new(e||t)},imports:[[c.c,n.g.forChild(Y)],n.g]}),t})();var J=a("mvOm"),K=a("jAig"),Z=a("WLNs");let tt=(()=>{class t{}return t.\u0275mod=l.Zb({type:t}),t.\u0275inj=l.Yb({factory:function(e){return new(e||t)},imports:[[c.c,G,K.a,s.a,y.b,i.a,Z.a,x.i,J.a]]}),t})()},"SV+Y":function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));var c=a("lJxs"),s=a("vkgz"),i=a("fXoL"),n=a("pD6V");let r=(()=>{class t{constructor(t){this.media=t,this.media$=this.media.asObservable(),this.mediaSubscription=this.getCurrentMedia().subscribe()}getCurrentMedia(){return this.media$.pipe(Object(c.a)(t=>t[0].mqAlias),Object(s.a)(t=>{const e=this.desktop;switch(t){case"xl":case"lg":case"md":this.desktop=!0;break;case"sm":case"xs":this.desktop=!1}this.mqAlias&&e!=this.desktop&&window.location.reload(),this.mqAlias=t}))}ngOnDestroy(){this.mediaSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.lc(n.g))},t.\u0275prov=i.Xb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);