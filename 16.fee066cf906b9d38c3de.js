(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{d6DY:function(t,e,c){"use strict";c.r(e),c.d(e,"TaskManagerModule",(function(){return st}));var a=c("ofXK"),s=c("YUcS"),i=c("PyEr"),n=c("0IaG"),o=c("fXoL");let r=(()=>{class t{}return t.\u0275mod=o.Zb({type:t}),t.\u0275inj=o.Yb({factory:function(e){return new(e||t)},providers:[],imports:[[a.c,n.h]]}),t})();var l=c("tyNb"),g=c("wZkO"),h=c("vkgz"),d=c("Brg/"),u=c("T1xj"),p=c("S6We"),m=c("znSr"),f=c("XiUz"),k=c("bTqV"),b=c("STbY"),S=c("NFeN"),O=c("kmnG"),x=c("qFsG"),v=c("3Pt+"),y=c("d3UM"),T=c("e/WU"),L=c("FKr1");function I(t,e){if(1&t&&(o.hc(0,"mat-option",19),o.Qc(1),o.gc()),2&t){const t=e.$implicit;o.zc("value",t),o.Ob(1),o.Rc(t)}}function C(t,e){if(1&t&&(o.hc(0,"mat-option",19),o.Qc(1),o.gc()),2&t){const t=e.$implicit;o.zc("value",t.value),o.Ob(1),o.Rc(t.label)}}function M(t,e){if(1&t&&(o.hc(0,"mat-option",19),o.Qc(1),o.gc()),2&t){const t=e.$implicit;o.zc("value",t._id),o.Ob(1),o.Rc(t.name)}}function w(t,e){if(1&t&&(o.hc(0,"mat-option",19),o.Qc(1),o.gc()),2&t){const t=e.$implicit;o.zc("value",t._id),o.Ob(1),o.Rc(t.name)}}let z=(()=>{class t{constructor(){this.getItems=new o.r,this.filters={_id:"",name:"",createdBy:"",participants:[],status:"",from:null,to:null,priority:"",project:""},this.options={status:["done","pending","overdue"],createdBy:[],participants:[],priority:[{label:"low",value:3},{label:"medium",value:2},{label:"high",value:1}]}}ngOnInit(){this.filters.project=this.projectId}ngOnChanges(t){t.participants&&this.participants&&(this.options.participants=d.d.copyObject(this.participants),this.options.createdBy=this.participants.filter(t=>"ADMIN_ROLE"===t.role))}setDate(t,e){this.filters[e]=t.getTime()}searchItems(){let t=d.d.toQueryString(this.filters);this.getItems.next(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Vb({type:t,selectors:[["app-task-manager-filter"]],inputs:{projectId:"projectId",participants:"participants"},outputs:{getItems:"getItems"},features:[o.Mb],decls:49,vars:19,consts:[["fxLayoutAlign","center"],["mat-button","","mat-mini-fab","","color","accent","ngClass.gt-xs","btn-search-desktop","ngClass.xs","btn-search-mobile",3,"matMenuTriggerFor"],["menuTrigger","matMenuTrigger"],["filtersMenu","matMenu"],["fxLayout","column",3,"click"],["fxLayout","row","fxLayoutAlign","space-around","fxLayoutGap","15px"],["fxFlex","40",1,"example-full-width"],["matInput","","placeholder","Task ID","autocomplete","off",3,"ngModel","ngModelChange"],["matInput","","placeholder","Task name","autocomplete","off",3,"ngModel","ngModelChange"],["fxLayout","row","fxLayoutGap","15px","fxLayoutAlign","space-around"],["fxFlex","40","appearance","fill"],["matNativeControl","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["multiple","","matNativeControl","",3,"ngModel","ngModelChange"],["fxLayout","column","fxLayoutAlign","center","fxFlex","40",1,"dates-container"],["dateFormat","time","placeholder","Start date",3,"ngModel","ngModelChange"],["dateFormat","time","placeholder","End date",3,"ngModel","ngModelChange"],["fxFlex","40","fxLayoutAlign","space-around"],["mat-mini-fab","","color","accent",1,"btn-search-dialog",3,"click"],[3,"value"]],template:function(t,e){if(1&t){const t=o.ic();o.hc(0,"div",0),o.hc(1,"button",1,2),o.hc(3,"mat-icon"),o.Qc(4,"search"),o.gc(),o.gc(),o.gc(),o.hc(5,"mat-menu",null,3),o.hc(7,"div",4),o.pc("click",(function(t){return t.stopPropagation()})),o.hc(8,"div",5),o.hc(9,"mat-form-field",6),o.hc(10,"mat-label"),o.Qc(11,"ID"),o.gc(),o.hc(12,"input",7),o.pc("ngModelChange",(function(t){return e.filters._id=t})),o.gc(),o.gc(),o.hc(13,"mat-form-field",6),o.hc(14,"mat-label"),o.Qc(15,"Name"),o.gc(),o.hc(16,"input",8),o.pc("ngModelChange",(function(t){return e.filters.name=t})),o.gc(),o.gc(),o.gc(),o.hc(17,"div",9),o.hc(18,"mat-form-field",10),o.hc(19,"mat-label"),o.Qc(20,"Status"),o.gc(),o.hc(21,"mat-select",11),o.pc("ngModelChange",(function(t){return e.filters.status=t})),o.Oc(22,I,2,2,"mat-option",12),o.gc(),o.gc(),o.hc(23,"mat-form-field",10),o.hc(24,"mat-label"),o.Qc(25,"Priority"),o.gc(),o.hc(26,"mat-select",11),o.pc("ngModelChange",(function(t){return e.filters.priority=t})),o.Oc(27,C,2,2,"mat-option",12),o.gc(),o.gc(),o.gc(),o.hc(28,"div",9),o.hc(29,"mat-form-field",10),o.hc(30,"mat-label"),o.Qc(31,"Creator/editor"),o.gc(),o.hc(32,"mat-select",11),o.pc("ngModelChange",(function(t){return e.filters.createdBy=t})),o.Oc(33,M,2,2,"mat-option",12),o.gc(),o.gc(),o.hc(34,"mat-form-field",10),o.hc(35,"mat-label"),o.Qc(36,"Participants"),o.gc(),o.hc(37,"mat-select",13),o.pc("ngModelChange",(function(t){return e.filters.participants=t})),o.Oc(38,w,2,2,"mat-option",12),o.gc(),o.gc(),o.gc(),o.hc(39,"div",5),o.hc(40,"div",14),o.hc(41,"lp-date-selector",15),o.pc("ngModelChange",(function(t){return e.setDate(t,"from")})),o.uc(42,"lpParseDate"),o.gc(),o.hc(43,"lp-date-selector",16),o.pc("ngModelChange",(function(t){return e.setDate(t,"to")})),o.uc(44,"lpParseDate"),o.gc(),o.gc(),o.hc(45,"div",17),o.hc(46,"button",18),o.pc("click",(function(){o.Hc(t);const c=o.Fc(2);return e.searchItems(),c.closeMenu()})),o.hc(47,"mat-icon"),o.Qc(48,"search"),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.gc()}if(2&t){const t=o.Fc(6);o.Ob(1),o.zc("matMenuTriggerFor",t),o.Ob(11),o.zc("ngModel",e.filters._id),o.Ob(4),o.zc("ngModel",e.filters.name),o.Ob(5),o.zc("ngModel",e.filters.status),o.Ob(1),o.zc("ngForOf",e.options.status),o.Ob(4),o.zc("ngModel",e.filters.priority),o.Ob(1),o.zc("ngForOf",e.options.priority),o.Ob(5),o.zc("ngModel",e.filters.createdBy),o.Ob(1),o.zc("ngForOf",e.options.createdBy),o.Ob(4),o.zc("ngModel",e.filters.participants),o.Ob(1),o.zc("ngForOf",e.options.participants),o.Ob(3),o.zc("ngModel",o.wc(42,13,e.filters.from,"date")),o.Ob(2),o.zc("ngModel",o.wc(44,16,e.filters.to,"date"))}},directives:[f.e,k.b,m.a,b.d,S.a,b.e,f.f,f.g,O.c,f.b,O.g,x.b,v.d,v.o,v.r,y.a,a.s,T.a,L.n],pipes:[i.b],styles:[".dates-container[_ngcontent-%COMP%]{margin:20px}.btn-search-desktop[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:10px}.btn-search-mobile[_ngcontent-%COMP%]{margin:15px}.btn-search-dialog[_ngcontent-%COMP%]{margin-top:25px}  .mat-menu-panel{top:0;max-width:none!important}"],changeDetection:0}),t})();var P=c("+0xr"),j=c("M9IT");const F=["paginator"];function Q(t,e){1&t&&(o.hc(0,"th",12),o.Qc(1," Name "),o.gc())}function _(t,e){if(1&t&&(o.hc(0,"td",13),o.Qc(1),o.gc()),2&t){const t=e.$implicit;o.Ob(1),o.Sc(" ",t.name," ")}}function D(t,e){1&t&&(o.hc(0,"th",12),o.Qc(1," Status "),o.gc())}const E=function(t){return{color:t}};function A(t,e){if(1&t&&(o.hc(0,"td",13),o.hc(1,"p",14),o.Qc(2),o.gc(),o.gc()),2&t){const t=e.$implicit;o.Ob(1),o.zc("ngStyle",o.Bc(2,E,!0===t.status?"#7b87cc":"#d1870c")),o.Ob(1),o.Sc(" ",t.status," ")}}function H(t,e){1&t&&(o.hc(0,"th",12),o.Qc(1," Priority "),o.gc())}function R(t,e){if(1&t&&(o.hc(0,"td",13),o.hc(1,"p",15),o.Qc(2),o.gc(),o.hc(3,"p",16),o.Qc(4),o.gc(),o.gc()),2&t){const t=e.$implicit;o.Ob(2),o.Sc(" ",1===t.priority?"HIGH":2===t.priority?"MEDIUM":"LOW"," "),o.Ob(2),o.Rc(t.priority)}}function N(t,e){1&t&&o.cc(0,"th",12)}function $(t,e){if(1&t){const t=o.ic();o.hc(0,"td",13),o.hc(1,"mat-icon",17),o.pc("click",(function(){o.Hc(t);const c=e.$implicit,a=o.tc();return a.taskSelected!=c._id?a.selectTask.next(c._id):null})),o.Qc(2,"launch"),o.gc(),o.gc()}if(2&t){const t=e.$implicit,c=o.tc();o.Ob(1),o.zc("color",c.taskSelected===t._id?"accent":"primary")}}function B(t,e){1&t&&o.cc(0,"tr",18)}function G(t,e){1&t&&o.cc(0,"tr",19)}let U=(()=>{class t{constructor(){this.pageSize=5,this.taskTotal=0,this.taskFrom=0,this.tasksList=[],this.selectTask=new o.r,this.getItems=new o.r,this.displayedColumns=["name","status","priority","options"]}ngOnInit(){}paginatorChange(t){this.getItems.emit(this.pageSize*t.pageIndex)}ngOnChanges(t){t.taskTotal&&null!=this.taskTotal&&this.paginator&&(this.paginator.pageIndex=0)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Vb({type:t,selectors:[["app-task-manager-list"]],viewQuery:function(t,e){var c;1&t&&o.Wc(F,!0),2&t&&o.Ec(c=o.qc())&&(e.paginator=c.first)},inputs:{taskTotal:"taskTotal",taskFrom:"taskFrom",taskSelected:"taskSelected",tasksList:"tasksList"},outputs:{selectTask:"selectTask",getItems:"getItems"},features:[o.Mb],decls:18,vars:5,consts:[["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","priority"],["matColumnDef","options","stickyEnd",""],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["fxLayoutAlign","center"],["fxFlex","100",3,"length","pageSize","page"],["paginator",""],["mat-header-cell",""],["mat-cell",""],[3,"ngStyle"],["fxHide.xs","","fxShow.gt-xs",""],["fxHide.gt-xs","","fxShow.xs",""],[3,"color","click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(o.hc(0,"table",0),o.fc(1,1),o.Oc(2,Q,2,0,"th",2),o.Oc(3,_,2,1,"td",3),o.ec(),o.fc(4,4),o.Oc(5,D,2,0,"th",2),o.Oc(6,A,3,4,"td",3),o.ec(),o.fc(7,5),o.Oc(8,H,2,0,"th",2),o.Oc(9,R,5,2,"td",3),o.ec(),o.fc(10,6),o.Oc(11,N,1,0,"th",2),o.Oc(12,$,3,1,"td",3),o.ec(),o.Oc(13,B,1,0,"tr",7),o.Oc(14,G,1,0,"tr",8),o.gc(),o.hc(15,"div",9),o.hc(16,"mat-paginator",10,11),o.pc("page",(function(t){return e.paginatorChange(t)})),o.gc(),o.gc()),2&t&&(o.zc("dataSource",e.tasksList),o.Ob(13),o.zc("matHeaderRowDef",e.displayedColumns),o.Ob(1),o.zc("matRowDefColumns",e.displayedColumns),o.Ob(2),o.zc("length",e.taskTotal)("pageSize",e.pageSize))},directives:[P.o,P.c,P.i,P.b,P.k,P.n,f.e,j.a,f.b,P.h,P.a,a.w,m.d,m.c,S.a,P.j,P.m],styles:["table[_ngcontent-%COMP%]{width:100%!important}"]}),t})();function Y(t,e){1&t&&o.cc(0,"router-outlet")}function K(t,e){1&t&&(o.hc(0,"h4",15),o.Qc(1,"NO TASK SELECTED"),o.gc())}function W(t,e){1&t&&(o.hc(0,"mat-icon"),o.Qc(1,"list"),o.gc())}function q(t,e){if(1&t){const t=o.ic();o.hc(0,"div",16),o.hc(1,"div",2),o.hc(2,"app-task-manager-filter",17),o.pc("getItems",(function(e){return o.Hc(t),o.tc().getTasks(e,0).subscribe()})),o.gc(),o.gc(),o.hc(3,"div",2),o.hc(4,"app-task-manager-list",18),o.pc("selectTask",(function(e){return o.Hc(t),o.tc().selectTask(e)}))("getItems",(function(e){o.Hc(t);const c=o.tc();return c.getTasks(c.taskQueryString,e).subscribe()})),o.gc(),o.gc(),o.gc()}if(2&t){const t=o.tc();o.Ob(2),o.zc("participants",t.participants)("projectId",t.selectedProject),o.Ob(2),o.zc("tasksList",t.tasksList)("taskSelected",t.taskSelected?t.taskSelected._id:null)("taskTotal",t.taskTotal)}}function V(t,e){1&t&&(o.hc(0,"div",19),o.hc(1,"h4"),o.Qc(2,"THERE ARE NO TASKS IN THE CURRENT PROJECT"),o.gc(),o.gc())}function Z(t,e){1&t&&o.cc(0,"router-outlet")}function J(t,e){1&t&&(o.hc(0,"div",19),o.hc(1,"h4"),o.Qc(2,"NO TASK SELECTED"),o.gc(),o.gc())}const X=function(){return{"margin-top":"70px"}};let tt=[{path:"",component:(()=>{class t{constructor(t,e,c,a){this.projectService=t,this.taskService=e,this.ar=c,this.router=a,this.tasksList=[],this.taskSkip=0,this.taskLimit=5,this.selectedProjectSubs=null,this.taskSubs=null}get taskSelectedName(){const t=this.tasksList.length>0?this.tasksList.find(t=>t._id===this.taskSelected):void 0;return t?t.name:""}ngOnInit(){this.listenProjectChanges(),this.listenTaskChanges(),this.selectedProject=this.projectService.selectedProject._id,this.taskSelected=d.c.get("state-data","task-selected"),this.selectedProject&&(this.getTasks("?project="+this.selectedProject,0).subscribe(()=>{this.taskSelected||(this.tasksList[this.tasksList.length-1]?this.navigateToTask(this.tasksList[this.tasksList.length-1]._id):this.taskSelected="")}),this.getParticipants())}listenProjectChanges(){this.selectedProjectSubs=this.projectService.selectedProject$.subscribe(t=>{this.selectedProject=t._id,this.removeTaskInStorage(),this.redirectTo("pages/task-manager")})}listenTaskChanges(){this.taskSubs=this.taskService.task$.subscribe(t=>{if(t)switch(t.action){case"POST":this.taskTotal++,this.taskLimit>this.tasksList.length&&(this.tasksList=[...this.tasksList,t.task]),this.taskSelected||this.navigateToTask(t.task._id);break;case"PUT":this.tasksList=this.tasksList.map(e=>e._id===t.task._id?t.task:e);break;case"DELETE":this.tasksList=this.tasksList.filter(e=>e._id!=t.task._id),this.taskSelected=t.task._id===this.taskSelected?"":this.taskSelected}})}getParticipants(){this.projectService.getParticipants(this.selectedProject).subscribe(t=>{this.participants=t})}getTasks(t,e){return this.taskQueryString=t,this.taskSkip=e,this.taskService.getTasks("month",this.taskQueryString,this.taskSkip,this.taskLimit).pipe(Object(h.a)(t=>{this.taskTotal=t.count,this.tasksList=t.tasks}))}selectTask(t){this.tabsGroup&&(this.tabsGroup.selectedIndex=1),this.navigateToTask(t,"info")}setTaskInStorage(){d.c.set("state-data",this.taskSelected,"task-selected")}removeTaskInStorage(){d.c.remove("state-data","task-selected")}redirectTo(t){this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>this.router.navigate([t]))}navigateToTask(t,e){this.taskSelected=t,this.router.navigate([this.taskSelected,e||d.c.get("state-data","task-manager-tab")||"info"],{relativeTo:this.ar})}ngOnDestroy(){this.selectedProjectSubs&&null!=this.selectedProjectSubs&&this.selectedProjectSubs.unsubscribe(),this.taskSubs&&null!=this.taskSubs&&this.taskSubs.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.bc(u.a),o.bc(p.a),o.bc(l.a),o.bc(l.d))},t.\u0275cmp=o.Vb({type:t,selectors:[["app-task-manager"]],viewQuery:function(t,e){var c;1&t&&o.Wc(g.c,!0),2&t&&o.Ec(c=o.qc())&&(e.tabsGroup=c.first)},decls:19,vars:14,consts:[["fxHide.lt-md","","fxShow.gt-sm","","fxLayoutAlign.gt-sm","space-around","fxLayout.lt-md","column","fxLayout.gt-sm","row",1,"task-manager-container"],["fxFlex.gt-sm","22","fxFlex.md","35","fxFlex.lt-md","30","fxLayout","column",3,"ngStyle.lt-md"],["fxLayoutAlign","center"],["fxFlex","100",3,"participants","projectId","getItems"],["fxFlex","100",3,"tasksList","taskSelected","taskTotal","selectTask","getItems"],["fxFlex.gt-sm","75","fxFlex.lt-md","70"],[4,"ngIf"],["class","div-no-tasks",4,"ngIf"],["fxHide.gt-sm","","fxShow.lt-md",""],["mat-stretch-tabs","","mat-align-tabs","center"],["mat-tab-label",""],["fxLayout","column",4,"ngIf"],["fxLayoutAlign","center","class","div-no-tasks",4,"ngIf"],[3,"label"],["class","div-no-tasks","fxLayoutAlign","center",4,"ngIf"],[1,"div-no-tasks"],["fxLayout","column"],["fxFlex","10",3,"participants","projectId","getItems"],["fxFlex","90",3,"tasksList","taskSelected","taskTotal","selectTask","getItems"],["fxLayoutAlign","center",1,"div-no-tasks"]],template:function(t,e){1&t&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.hc(3,"app-task-manager-filter",3),o.pc("getItems",(function(t){return e.getTasks(t,0).subscribe()})),o.gc(),o.gc(),o.hc(4,"div",2),o.hc(5,"app-task-manager-list",4),o.pc("selectTask",(function(t){return e.selectTask(t)}))("getItems",(function(t){return e.getTasks(e.taskQueryString,t).subscribe()})),o.gc(),o.gc(),o.gc(),o.hc(6,"div",5),o.Oc(7,Y,1,0,"router-outlet",6),o.hc(8,"div",2),o.Oc(9,K,2,0,"h4",7),o.gc(),o.gc(),o.gc(),o.hc(10,"div",8),o.hc(11,"mat-tab-group",9),o.hc(12,"mat-tab"),o.Oc(13,W,2,0,"ng-template",10),o.Oc(14,q,5,5,"div",11),o.Oc(15,V,3,0,"div",12),o.gc(),o.hc(16,"mat-tab",13),o.Oc(17,Z,1,0,"router-outlet",6),o.Oc(18,J,3,0,"div",14),o.gc(),o.gc(),o.gc()),2&t&&(o.Ob(1),o.zc("ngStyle.lt-md",o.Ac(13,X)),o.Ob(2),o.zc("participants",e.participants)("projectId",e.selectedProject),o.Ob(2),o.zc("tasksList",e.tasksList)("taskSelected",e.taskSelected?e.taskSelected:null)("taskTotal",e.taskTotal),o.Ob(2),o.zc("ngIf",e.taskSelected),o.Ob(2),o.zc("ngIf",!e.taskSelected),o.Ob(5),o.zc("ngIf",e.tasksList.length>0),o.Ob(1),o.zc("ngIf",0===e.tasksList.length),o.Ob(1),o.zc("label",e.taskSelected?e.taskSelectedName:""),o.Ob(1),o.zc("ngIf",e.taskSelected),o.Ob(1),o.zc("ngIf",!e.taskSelected))},directives:[m.c,f.e,f.f,f.b,m.d,z,U,a.t,g.c,g.a,g.d,l.h,S.a],styles:[".task-manager-container[_ngcontent-%COMP%]{height:88vh}@media (max-width:1279px){.task-manager-container[_ngcontent-%COMP%]{height:75vh!important}}  .mat-tab-body-wrapper{height:100%!important;margin:0!important}.div-no-tasks[_ngcontent-%COMP%]{margin:50px}"]}),t})(),children:[{path:":id",loadChildren:()=>Promise.all([c.e(0),c.e(15)]).then(c.bind(null,"e+hA")).then(t=>t.TaskManagerPanelModule)}]}],et=(()=>{class t{}return t.\u0275mod=o.Zb({type:t}),t.\u0275inj=o.Yb({factory:function(e){return new(e||t)},imports:[[a.c,l.g.forChild(tt)],l.g]}),t})();var ct=c("jAig"),at=c("mvOm");let st=(()=>{class t{}return t.\u0275mod=o.Zb({type:t}),t.\u0275inj=o.Yb({factory:function(e){return new(e||t)},imports:[[a.c,et,ct.a,s.a,T.b,i.a,r,v.i,at.a]]}),t})()}}]);